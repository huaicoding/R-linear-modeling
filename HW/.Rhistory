q()
load("C:/Users/Javis/Desktop/STAT 151/R-linear-modeling/.RData")
git add .
ggplot(data, aes(x = energy, y = track_popularity)) + geom_point()
library(tidyverse)
library(ggpubr)
data <- read.csv("spotify_songs.csv", encoding = "UTF - 8")
getwd()
setwd(dir = "C:/Users/Javis/Desktop/STAT 151/R-linear-modeling/HW1")
data <- read.csv("spotify_songs.csv", encoding = "UTF - 8")
ggplot(data, aes(x = energy, y = track_popularity)) + geom_point()
model <- lm(track_popularity ~ energy, data = data)
summary(model)
ggplot(data, aes(energy, track_popularity)) + geom_point() +
stat_smooth(method = lm)
ggplot(data, aes(x = energy, y = track_popularity > 5)) + geom_point()
model <- lm(track_popularity > 5 ~ energy, data = data)
summary(model)
ggplot(data, aes(energy, track_popularity > 5)) + geom_point() +
stat_smooth(method = lm)
data_2 <- data[which(data$track_popularity > 5)]
data_2 <- data[which(data$track_popularity > 5),]
ggplot(data_2, aes(x = energy, y = track_popularity )) + geom_point()
model <- lm(track_popularity ~ energy, data = data_2)
summary(model)
ggplot(data_2, aes(energy, track_popularity)) + geom_point() +
stat_smooth(method = lm)
data_2 <- data[which(data$track_popularity > 10),]
ggplot(data_2, aes(x = energy, y = track_popularity )) + geom_point()
model <- lm(track_popularity ~ energy, data = data_2)
summary(model)
ggplot(data_2, aes(energy, track_popularity)) + geom_point() +
stat_smooth(method = lm)
summary(model)$coef
data <- read.csv("bodyfat.csv", encoding = "UTF - 8")
model <- lm(bodyfa ~ Weight + Height, data = data)
data <- read.csv("bodyfat.csv", encoding = "UTF - 8")
model <- lm(bodyfat ~ Weight + Height, data = data)
summary (model)
summary(modle)$call + coef
summary(model)$call + coef
summary(modle)$call + summary(modle)$coef
summary(model)$call + summary(model)$coef
summary(modle)$call&coef
summary(model)$call&coef
summary(model)$call
summary(model)$coef
x1 <- data$Weight
x2 <- data$Height
y <- data$bodyfat
X <- matrix(c(rep(1, length(x1)), x1, x2), nrow = length(x1))
Y <- matrix(y)
X
Y
beta_hat <- solve(t(X) %*% X) %*% t(X) %*% y
beta_hat
calc_beta <- function(X, Y){
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
return beta
calc_beta <- function(X, Y){
beta_hat <- solve(t(X) %*% X) %*% t(X) %*% Y
return(beta_hat)
}
calc_beta(X,Y)
library(tidyverse)
library(ggpubr)
setwd(dir = "C:/Users/Javis/Desktop/STAT 151/R-linear-modeling/HW1")
data <- read.csv("bodyfat.csv", encoding = "UTF - 8")
x1 <- data$Weight
x2 <- data$Height
y <- data$bodyfat
X <- matrix(c(rep(1, length(x1)), x1, x2), nrow = length(x1))
Y <- matrix(y)
calc_beta <- function(X, Y){
beta_hat <- solve(t(X) %*% X) %*% t(X) %*% Y
return(beta_hat)
}
calc_beta(X,Y)
al_df <- read.csv("bodyfat.csv", encoding = "UTF - 8") %>%
filter(Strain < 0.0035, Strain > 0.0001,
loading_type == "T", temp == 20, lot == "A")
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filter(Strain < 0.0035, Strain > 0.0001,
loading_type == "T", temp == 20, lot == "A")
head(al_df)
ggplot(al_df) +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)))
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filterfilter(loading_type == "T", temp == 20, lot == "A")
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filter(loading_type == "T", temp == 20, lot == "A")
al_reg_df <- al_df %>% filter(Strain < 0.0035, Strain > 0.0001)
reg <- lm(Stress_MPa ~ 1 + Strain, data = al_reg_df)
al_reg_df$fit <- reg$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen))) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filter(loading_type == "T", temp == 20, lot == "A")
al_reg_df <- al_df %>% filter(Strain < 0.0035, Strain > 0.0001)
reg <- lm(Stress_MPa ~ Strain, data = al_reg_df)
al_reg_df$fit <- reg$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen))) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
summary(reg)
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filter(loading_type == "T", temp == 20, lot == "A")
al_reg_df <- al_df %>% filter(Strain < 0.0035, Strain > 0.0001)
reg <- lm(Stress_MPa ~ 1 + Strain, data = al_reg_df)
al_reg_df$fit <- reg$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen))) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
summary(reg)
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=1, data=al_reg_df)
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
reg_org <- lm(Stress_MPa ~ 0 + Strain, data = al_reg_df)
al_reg_df_org$fit2 <- reg_org$fitted.values
reg_org <- lm(Stress_MPa ~ 0 + Strain, data = al_reg_df)
al_reg_df$fit2 <- reg_org$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit2, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
summary(reg)
reg_org <- lm(Stress_MPa ~ 0 + Strain, data = al_reg_df)
al_reg_df$fit2 <- reg_org$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit2, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
summary(reg_org)
al_df <- read.csv("aluminum_dataset.csv", encoding = "UTF - 8") %>%
filter(loading_type == "T", temp == 20, lot == "A")
al_reg_df <- al_df %>% filter(Strain < 0.0035, Strain > 0.0001)
reg <- lm(Stress_MPa ~ 1 + Strain, data = al_reg_df) # with intersect
al_reg_df$fit1 <- reg$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit1, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
reg_org <- lm(Stress_MPa ~ 0 + Strain, data = al_reg_df) # without intersect
al_reg_df$fit2 <- reg_org$fitted.values
al_df %>% filter(Strain < 0.0035) %>%
ggplot() +
geom_point(aes(x=Strain, y=Stress_MPa, color=factor(specimen)), size = 1) +
geom_line(aes(x=Strain, y=fit2, color="All Specimen Fitted"), lwd=2, data=al_reg_df)
summary(reg)
summary(reg_org)
summary(reg)$residuals
summary(reg_org)$resi
summary(reg)
summary(reg_org)
source("~/Desktop/R-151A/R-linear-modeling/HW1/HW01.R")
